<!DOCTYPE html>
<html>
  <head>
    <title>Learning Angular</title>
    <!--suppress JSUnresolvedLibraryURL -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
  </head>


  <body>
    <a href="https://docs.angularjs.org/api/" target="_blank">Learning AngularJS...</a>
    <!--
    /**
     * View in the sense of the MVC-pattern
     */
    -->
    <div ng-app="flug"> <!-- bind onto module via directive -->
      <div ng-controller="FlugBuchenCtrl"></div> <!-- bind onto controller via directive -->
    </div>
    <!--
      Known directives
      ----------------
      ng-app -> module
      ng-controller
      ng-show
      ng-hide
      ng-bind -> 1-way-databinding
      ng-model -> 2-way-databinding
      ng-click
      ng-change
      ng-blur
      ng-focus
      ng-checked
      ng-repeat
      ng-class (css-class)
    -->
  </body>

  <script>
    console.log('Starting angular-stuff...');

    // AngularJS strukturiert Anwendungen anhand von Modulen
    // Ein Modul kapselt wiederverwendbare Programmteile und Konfigurationsinformationen
    // Zu diesen Programmteilen zählen Controller im Sinne des MVC-Musters. Bei Controllern
    // handelt es sich unter AngularJS um Einheiten, welche Models (bzw. View-Models) bereitstellen
    // Eine View kümmert sich in weiterer Folge um deren Visualsierung.
    // Bereitstellung eines Moduls mit einem Controller:
    var app = angular.module('flug', []); // 'Modulname', [] mit zu importierenden Modulen // 'ng' is imported by default

    /**
     * Controller in the sense of the MVC-pattern - will provide a model respectively a view-model
     */
    // AngularJS treats parameters as dependendencies and calls them "Services"
    // Second param of app.controller() is the controller-constructorfunction (will provide a model-object to bind it to the view)
    app.controller('FlugBuchenCtrl', function($scope, $http) { // "wellknown names" (AngularJS will inject the dependencies)
        // List of "Services" (= dependencies = wellknown Names)
        // 1) The $scope is the model of the MVC-pattern
        // 2) $http allows accessing http resources the easy way

debugger;

      // a controller will provide the (view-)model via its scope
      $scope.vm = new FlugBuchenVM($http); // vm = view-model
      // dedicated view-model vs. self-created view-model
      // $scope.vm = {... loadFluege: function() { ... } ...}; //
    });


    /**
     * Model respectively view-model.
     */
    function Flug(id, abflugort, zielort, datum) {
      this.id = id;
      this.abflugort = abflugort;
      this.zielort = zielort;
      this.datum = datum;
    }

    function FlugBuchenVM($http) {
      var that = this;

      this.fluege = [];

      this.selectedFlug = null;

      this.message = "";
      this.flugNummerFilter = "";
      this.flugVonFilter = "";
      this.flugNachFilter = "";

      this.loadFluege = function() {
        that.fluege.push(new Flug(1, "Graz", "Essen", new Date()));
        that.fluege.push(new Flug(2, "Graz", "Frankfurt", new Date()));
      };

      this.selectFlug = function(f) {
        this.selectedFlug = f;
      }
    }

    console.log('...finished it.');
  </script>
</html>
